 <!DOCTYPE html>
 <html lang="en">

 <head>
     <meta charset="utf-8" />
     <link rel="apple-touch-icon" sizes="76x76" href="../assets/img/apple-icon.png">
     <link rel="icon" type="image/png" href="../assets/img/favicon.png">
     <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
     <title>
         #ShoutOut Portal
     </title>
     <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
     <!--     Fonts and icons     -->
     <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
     <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
     <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
     <!-- CSS Files -->
     <link href="../assets/css/material-dashboard.css?v=2.1.0" rel="stylesheet" />
     <!-- CSS Just for demo purpose, don't include it in your project -->
     <!--<link href="../assets/demo/demo.css" rel="stylesheet" />-->
     <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.16/css/jquery.dataTables.min.css" />
     <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap3-dialog/1.34.9/css/bootstrap-dialog.min.css" rel="stylesheet" type="text/css" />
     <link href="wiz_assets/css/themify-icons.css" rel="stylesheet">
     <style>
         .modal-header {
             background-color: #683589;
             padding: 16px 16px;
             color: #fff;
         }

         .my-primary {
             color: #fff;
             background-color: #683589;
             min-height: 20px;
             font-size: 20px
         }




         /*border-bottom: 2px dashed #337AB7;*/
     </style>

 </head>
 <!--<div  style="background-color: #887711">-->

 <body class="">

     <div class="wrapper ">
         <!--TODO Please change the Images here-->
         <div class="sidebar" data-color="purple" data-background-color="white" data-image="../assets/img/sidebar-1.jpg">
             <div class="logo">
                 <font color="#E64E00 " size="5"><center>#ShoutOut Portal</center></font>
                 <!--<i class="far fa-star"></i>-->
             </div>
             <div class="sidebar-wrapper">
                 <ul class="nav" id="navItems">
                     <li class="nav-item ">
                         <a class="nav-link" href="index.html">
                             <i class="material-icons">person</i>
                             <p>Nominate A Hollardite</p>
                         </a>
                     </li>
                     <li class="nav-item ">
                         <a class="nav-link" href="Vote.html">
                             <i class="material-icons">thumb_up</i>
                             <p>Vote For A Nomination</p>
                         </a>
                     </li>
                     <li class="nav-item active">
                         <a class="nav-link" href="leaderboard.html">
                             <i class="material-icons">dashboard</i>
                             <p>Leader Board</p>
                         </a>
                     </li>
                     <li class="nav-item ">
                         <a class="nav-link" href="Admin.html">
                             <i class="material-icons">security</i>
                             <p>Admin</p>
                         </a>
                     </li>
                 </ul>
             </div>
         </div>
         <div class="main-panel">
             <!-- Navbar -->
             <nav class="navbar navbar-expand-lg navbar-transparent navbar-absolute fixed-top ">
                 <div class="container-fluid">
                     <div class="navbar-wrapper">
                         <a class="navbar-brand"><font color="#E64E00" size="4">Leaderboard</font></a>
                     </div>
                     <button class="navbar-toggler" type="button" data-toggle="collapse" aria-controls="navigation-index" aria-expanded="false" aria-label="Toggle navigation">
                         <span class="sr-only">Toggle navigation</span>
                         <span class="navbar-toggler-icon icon-bar"></span>
                         <span class="navbar-toggler-icon icon-bar"></span>
                         <span class="navbar-toggler-icon icon-bar"></span>
                     </button>
                     <div class="collapse navbar-collapse justify-content-end">
                         <!--Todo MZ Parak Add search functionality when the requirment arrises-->
                         <!--<form class="navbar-form">
                          <div class="input-group no-border">
                            <input type="text" value="" class="form-control" placeholder="Search...">
                            <button type="submit" class="btn btn-white btn-round btn-just-icon">
                              <i class="material-icons">search</i>
                              <div class="ripple-container"></div>
                            </button>
                          </div>
                        </form>-->
                         <ul class="navbar-nav">
                             <!--// Todo make this available to HR Admin only-->
                            
                             <!--<li class="nav-item dropdown">
        <a class="nav-link" href="" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <i class="material-icons">notifications</i>
            <span class="notification">5</span>
            <p class="d-lg-none d-md-block">
                Notifications
            </p>
        </a>
        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownMenuLink">
            <a class="dropdown-item" href="#">Your Notification Of Mohammed Parak Was Succesfully Added</a>
            <a class="dropdown-item" href="#">You earned 100 points for nominating a hollodite</a>
            <a class="dropdown-item" href="#">Your Notification Of Kaironn Akoo Was Succesfully Added</a>
            <a class="dropdown-item" href="#">You earned 100 points for nominating a hollodite</a>
        </div>
    </li>-->
                             <li class="nav-item">
                                 <a class="nav-link"  data-toggle="modal" data-target="#thanksModal">
                                     <i class="fas fa-heart"></i>
                                     <p class="d-lg-none d-md-block">
                                         Give Thanks
                                     </p>
                                 </a>
                             </li>
                             <li class="nav-item">
                                 <!--Todo Add the a drop down to expose user logged in profile-->
                                 <a class="nav-link" href="" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                     <i class="material-icons">person</i>
                                     <p class="d-lg-none d-md-block">
                                         Account
                                     </p>
                                 </a>
                                 <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownMenuLink">
                                     <a class="dropdown-item" href="#" id="loggedInUser" onClick="showProfile();">Profile</a>
                                     <a class="dropdown-item" href="#" id="loggedInUser" onClick="logout();">Logout</a>
                                     <!--<button type="button" class="btn btn-primary btn-vote" id="btnLogout"></button>-->
                                 </div>
                             </li>
                         </ul>
                     </div>
                 </div>
             </nav>
             <!-- End Navbar -->
             <div class="content" style="background-color: #44b4a6">
                 <div class="container-fluid">
                     <div class="row">
                         <div class="col-md-12">
                             <div class="card">
                                 <div class="card-header card-header-primary">
                                     <h4 class="card-title ">#ShoutOut Leaderboard</h4>
                                     <!--<p class="card-category">Please vote for the <b>#ShoutOuts</b> that you believe are <b>#StandOuts</b></p>-->
                                 </div>
                                 <div class="card-body">
                                     <div class="table-responsive">
                                         <table id="leaderTable" class="table">
                                             <thead class=" text-primary">
                                             <th>
                                                 Hollardite
                                             </th>
                                             <th>
                                                 Branch
                                             </th>
                                             <th>
                                                 Department
                                             </th>
                                             <th>
                                                 Score
                                             </th>

                                             </thead>
                                             <tbody id="leaderTbody"></tbody>
                                         </table>
                                     </div>
                                 </div>
                             </div>
                         </div>
                     </div>
                 </div>
             </div>
             <div style="background-color: #44b4a6">
                 <footer class="footer">
                     <div class="container-fluid">
                         <nav class="float-left">
                             <ul>
                                 <!--<h6> Appreciation Portal 2018</h6>-->
                                 <!--<li>
                                    <a href="">
                                        About Us
                                    </a>
                                </li>-->

                             </ul>
                         </nav>
                         <div class="copyright float-right">
                             <script>
                                 document.write(new Date().getFullYear())
                             </script>, made with <i class="material-icons">favorite</i> by Hollardites For Hollardites
                         </div>
                     </div>
                 </footer>
             </div>
         </div>
     </div>
     <div class="modal" tabindex="-1" role="dialog" id="modalProfile">
         <div class="modal-dialog" role="document">
             <div class="modal-content">
                 <div class="modal-header">
                     <h5 class="modal-title">Your Profile</h5>
                     <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                         <span aria-hidden="true">&times;</span>
                     </button>
                 </div>
                 <div class="modal-body">
                     <div class="col-md-12">
                         <div class="card card-profile">
                             <div class="card-avatar">
                                 <a href="#pablo">
                                     <img class="img" src="../assets/img/faces/marc.jpg" />
                                 </a>
                             </div>
                             <div class="card-body">
                                 <h6 class="card-category text-gray" id="ProfileJobTitle"></h6>
                                 <h4 class="card-title" id="ProfileName"></h4>
                                 <p class="card-description">
                                     <h4>Your Badges</h4> <font color="#887711" size="8">&nbsp<i class="ti-star"></i>&nbsp<i class="ti-star"></i>&nbsp</font>
                                 </p>
                                 <!--<a href="#pablo" class="btn btn-primary btn-round">Follow</a>-->
                             </div>
                         </div>
                     </div>
                 </div>
                 <div class="modal-footer">
                     <!--<button type="button" class="btn btn-success btn-vote" id="btnSubmitVote">I Like This</button>-->
                     <!--<button type="button" class="btn btn-danger btn-vote" data-dismiss="modal" id="btnDecline">Decline Vote!</button>-->
                     <!--<button type="button" class="btn btn-default btn-close" data-dismiss="modal" id="Close">Close</button>-->
                 </div>
             </div>
         </div>
     </div>

     <div id="thanksModal" class="modal fade" role="dialog">
         <div class="modal-dialog">

             <!-- Modal content-->
             <div class="modal-content">
                 <div class="modal-header">
                     <h4 class="modal-title">Give Thanx! </h4>
                     <button type="button" class="close" data-dismiss="modal">&times;</button>

                 </div>
                 <div class="modal-body">
                     <div class="form-group">
                         <h6>Name</h6>
                         <select class="form-control" id="HolUserNames"></select>
                     </div>
                     <textarea rows="4" cols="50" maxlength="150" id="thanksText"></textarea>
                 </div>
                 <div class="modal-footer">
                     <!--<button type="button" class="btn btn-default" id="btnThanks"><i class="material-icons">thumb_up</i></button>-->
                     <a class="nav-link" href="#" id="btnThanks" data-dismiss ="modal">
                         <font color="#887711" size="15">
                             <i class="ti-thumb-up"></i>
                         </font>
                     </a>
                 </div>
             </div>

         </div>
     </div>

     <!--   Core JS Files   -->
     <script src="../assets/jQuery-3.3.1/jquery-3.3.1.min.js" type="text/javascript"></script>
     <script src="../assets/jQuery-3.3.1/jquery-3.3.1.js" type="text/javascript"></script>
     <!--<script type="text/javascript" src="https://cdn.datatables.net/v/bs-3.3.7/jq-2.2.4/jszip-3.1.3/pdfmake-0.1.27/dt-1.10.15/b-1.3.1/b-colvis-1.3.1/b-flash-1.3.1/b-html5-1.3.1/b-print-1.3.1/cr-1.3.3/fc-3.2.2/fh-3.1.2/kt-2.2.1/r-2.1.1/rg-1.0.0/rr-1.2.0/sc-1.4.2/se-1.2.2/datatables.min.js"></script>-->

     <script src="../assets/js/core/popper.min.js" type="text/javascript"></script>
     <script src="../assets/js/core/bootstrap-material-design.min.js" type="text/javascript"></script>
     <script src="../assets/js/plugins/perfect-scrollbar.jquery.min.js"></script>
     <script src="../assets/DataTables-1.10.18/js/jquery.dataTables.min.js" type="text/javascript"></script>

     <!--<!--  Google Maps Plugin    --> <!--will use for brancj location at a later stage-->
     <!--<script src="https://maps.googleapis.com/maps/api/js?key=YOUR_KEY_HERE"></script>-->
     <!-- Chartist JS -->
     <script src="../assets/js/plugins/chartist.min.js"></script>
     <!--  Notifications Plugin    -->
     <script src="../assets/js/plugins/bootstrap-notify.js"></script>
     <!-- Control Center for Material Dashboard: parallax effects, scripts for the example pages etc -->
     <script src="../assets/js/material-dashboard.min.js?v=2.1.0" type="text/javascript"></script>
     <!-- Material Dashboard DEMO methods, don't include it in your project! -->
     <script src="../assets/demo/demo.js"></script>
     <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap3-dialog/1.34.9/js/bootstrap-dialog.min.js"></script>
     <!--Data for page-->
     <script>
         var types = [BootstrapDialog.TYPE_DEFAULT,
         BootstrapDialog.TYPE_INFO,
         BootstrapDialog.TYPE_PRIMARY,
         BootstrapDialog.TYPE_SUCCESS,
         BootstrapDialog.TYPE_WARNING,
         BootstrapDialog.TYPE_DANGER];

         var buttons = [];
         var loggedInUserName = localStorage.getItem('loggedInUserName');
         var loggedInUserId = localStorage.getItem('loggedInUserId');
         var loggedInUserRole = localStorage.getItem('loggedInUserRole');

         var loggedInUserFullName = localStorage.getItem('loggedInUserFullName');
         var loggedInUserBarnch = localStorage.getItem('loggedInUserBranch');
         var loggedInUserDepartment = localStorage.getItem('loggedInUserDepartment');
         var loggedInUserManger = localStorage.getItem('loggedInUserManger');
         var loggedInUserJobTitle = localStorage.getItem('loggedInUserJobTitle');


         var leaderData;
        $(document).ready(function () {
                 tempNomId = -1
                 md.initDashboardPageCharts();

                 //$(".loggedInUser a").click(function () {

                 //    localStorage.clear();
                 //    window.location.replace("login.html");
                 //});

                 init();
                 $("#btnLogout").html('Logout: ' + loggedInUserName);
                 $("#ProfileJobTitle").text(loggedInUserJobTitle);
                 $("#ProfileName").text(loggedInUserFullName);




                 if (loggedInUserRole != "admin") {
                     document.getElementById("navItems").children[3].style.display = "none"
                 }

                 // $('#loggedInUser').text("Logged In As " + loggedInUserName);

                 $("#btnLogout").click(function () {
                     localStorage.clear();
                     window.location.replace("login.html");
                 });

            getusers();

             });
         

         function showProfile() {
             //localStorage.clear();
             //window.location.replace("login.html");
             $('#modalProfile').modal('show');
         }


         function logout() {
             localStorage.clear();
             window.location.replace("login.html");
         }

         function init() {

             getLeadersJSON(function (response) {
                 // Parse JSON string into object
                 var leaders = JSON.parse(response);
                 if (leaders != null) {
                     leaderData = leaders;
                     populateLeaderTable(leaderData);
                 }
             });
         }

         function getLeadersJSON(callback) {

             uri = "http://hsshidevweb01/AgRest/getNoms?action=Stats";
             var xobj = new XMLHttpRequest();
             xobj.overrideMimeType("application/json");
             xobj.open('GET', uri, false); // Replace 'my_data' with the path to your file
             xobj.onreadystatechange = function () {
                 if (xobj.readyState == 4 && xobj.status == "200") {
                     // Required use of an anonymous callback as .open will NOT return a value but simply returns undefined in asynchronous mode
                     callback(xobj.responseText);
                 }
             };
             xobj.send(null);
         }

         function populateLeaderTable(leaderData) {
             if (leaderData != null) {
                 var tableDataTag
                 $.each(leaderData, function (index, data) {
                     if (index == 0) {
                         tableDataTag = '<td><font color="#887711" size="5">' + data.Points + '&nbsp <i class="ti-cup"> </i>&nbsp</font ></td>';
                     }
                     else {
                         tableDataTag = '<td><font color="#E64E00" size="4">' + data.Points + '</font></td >';
                     }

                     $('#leaderTbody').append('<tr> ' +
                         '<td><font color="#E64E00" size="4">' + data.FullName + '</font></td>' +
                         '<td><font color="#E64E00" size="4">' + data.Branch + '</font></td>' +
                         '<td><font color="#E64E00" size="4">' + data.Department + '</font></td>' +
                         tableDataTag +

                         '</tr>');
                 });
             }

             var table = document.getElementsByTagName("table")[0];
             var tbody = table.getElementsByTagName("tbody")[0];
             var test = 1
             var voteTable = $('#leaderTable').DataTable({
                 //buttons: ['excel', 'pdf'],
                 "scrollY": "",
                 "scrollCollapse": true,
                 "order": [[3, "desc"]]
             });
         }
         $("#btnThanks").on('click', (function (e) {
             //user info var declarations
             var Nominator = loggedInUserId;
             var Nominee = $('#HolUserNames').val();
             var ThanksInfo;

             //Build Values Array
             values = [];

             var writeUptxt = document.getElementById("thanksText").value;

             var obj =
                 {
                     writeUp: writeUptxt
                 };

             ThanksInfo = JSON.stringify(obj);
             //build Nomination object
             Thanks = {

                 "NominatorId": Nominator,
                 "NomineeId": Nominee,
                 "ThanksDetails": writeUptxt
             };

             jsonThanks = JSON.stringify(Thanks);
             SubmitThanksJSON(function (response) {
                 // Parse JSON string into object
                 var result = JSON.stringify(response);

             });
         }));
         function getusers() {

             getUsersJSON(function (response) {
                 // Parse JSON string into object
                 response.addheader
                 var userNames = JSON.parse(response);
                 if (userNames != null) {
                     userData = userNames;
                     populateUserNameDropdown(userNames);
                 }
             });
         }
         function getUsersJSON(callback) {

             uri = "http://hsshidevweb01/AgRest/Users?action=GetUsers";
             //uri = "https://appreworkflow.eu-gb.mybluemix.net/getusers";
             var xobj = new XMLHttpRequest();
             //xobj.add
             xobj.overrideMimeType("application/json");
             xobj.open('GET', uri, true); // Replace 'my_data' with the path to your file
             xobj.onreadystatechange = function () {
                 if (xobj.readyState == 4 && xobj.status == "200") {
                     // Required use of an anonymous callback as .open will NOT return a value but simply returns undefined in asynchronous mode
                     callback(xobj.responseText);

                 }
             };
             xobj.send(null);
         }

         function populateUserNameDropdown(data) {
             $.each(data, function (i, option) {
                 //$('#HolUserNames').append($('<option/>').attr("value", option.userId).text(option.firstName));
                 let dropdown = document.getElementById('HolUserNames');
                 dropdown.length = 0;

                 let defaultOption = document.createElement('option');
                 defaultOption.text = 'Please Select';

                 dropdown.add(defaultOption);
                 dropdown.selectedIndex = 0;
                 for (let i = 0; i < data.length; i++) {
                     option = document.createElement('option');
                     option.text = data[i].FirstName + " " + data[i].Surname;
                     option.value = data[i].Id;
                     dropdown.add(option);
                 }
             });
         }
         function SubmitThanksJSON(callback) {

             var url = "http://hsshidevweb01/AgRest/addNom?action=Thanks";
             var xhr = new XMLHttpRequest();
             xhr.open("POST", url, true);
             xhr.overrideMimeType("application/json");
             xhr.onreadystatechange = function () {
                 if (xhr.readyState == 4 && xhr.status == 200) {
                     callback(xhr.responseText);
                     //BootstrapDialog.show({
                     //    type: BootstrapDialog.TYPE_SUCCESS,
                     //    title: 'SUCCESS',
                     //    message: 'Your Nomination Has Been Submited For Review.'
                     //});

                 }
             }
             var data = jsonThanks;
             xhr.send(data);
         }





     </script>
 </body>
 <!--</div>-->
 </html>